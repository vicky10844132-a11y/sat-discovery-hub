<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPTM SOVEREIGN // BASELINE LOCKED</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        /* --- THEME: DEEP SEA BLUE & SIGNAL YELLOW --- */
        :root {
            --bg-body: #020b16;
            --bg-panel: #051e3e;
            --border: #1e3a5f;
            
            --accent-yellow: #ffd700; 
            --accent-green: #10b981;
            --accent-amber: #f59e0b;
            --accent-data-23: #64748b; /* Grey/Silver for 2023 Baseline */
            --accent-data-25: #3b82f6; /* Blue for 2025 */
            
            --font-mono: "JetBrains Mono", monospace;
            --font-ui: "Inter", sans-serif;
        }

        body.god-mode { --border: var(--accent-yellow); }
        body.god-mode .sidebar { border-right: 1px solid var(--accent-yellow); }

        * { box-sizing: border-box; outline: none; }
        body { margin: 0; padding: 0; font-family: var(--font-ui); background: var(--bg-body); color: #ccc; overflow: hidden; height: 100vh; width: 100vw; cursor: default; }
        
        #app { display: flex; flex-direction: column; height: 100%; filter: blur(10px); transition: 0.8s; pointer-events: none; }
        #app.unlocked { filter: blur(0); pointer-events: all; }

        /* --- LOGIN --- */
        #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; background: rgba(2, 11, 22, 0.95); display: flex; justify-content: center; align-items: center; flex-direction: column; }
        .login-box { width: 420px; padding: 30px; border: 1px solid var(--border); background: var(--bg-panel); box-shadow: 0 0 50px rgba(0,0,0,0.5); border-radius: 8px; }
        .login-title { font-size: 24px; font-weight: 900; color: #fff; margin-bottom: 20px; letter-spacing: 2px; text-align: center; text-transform: uppercase; }
        .login-input { width: 100%; background: #020b16; border: 1px solid var(--border); color: #fff; padding: 10px; font-family: var(--font-mono); font-size: 12px; margin-bottom: 10px; border-radius: 4px; cursor: text; }
        .enter-btn { width: 100%; background: var(--accent-yellow); color: #000; border: none; padding: 12px; font-weight: 800; cursor: pointer; margin-top: 15px; border-radius: 4px; transition: 0.2s; letter-spacing: 1px; }
        .enter-btn:hover { background: #fff; }
        .verify-btn { float: right; background: transparent; color: var(--accent-yellow); border: 1px solid var(--accent-yellow); padding: 4px 8px; font-size: 10px; cursor: pointer; margin-top: -5px; margin-bottom: 10px; border-radius: 2px; }

        /* ZODIAC */
        .z-title { font-size: 10px; color: #888; margin: 15px 0 5px 0; text-transform: uppercase; letter-spacing: 1px; }
        .zodiac-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 5px; margin-bottom: 10px; }
        .z-btn { background: rgba(0,0,0,0.2); border: 1px solid var(--border); color: #666; padding: 5px; cursor: pointer; text-align: center; border-radius: 4px; transition: 0.2s; }
        .z-btn:hover, .z-btn.selected { border-color: var(--accent-yellow); color: var(--accent-yellow); background: rgba(255, 215, 0, 0.1); }
        .z-icon { font-size: 16px; }

        /* --- APP HEADER --- */
        header { height: 50px; border-bottom: 1px solid var(--border); background: var(--bg-panel); display: flex; align-items: center; justify-content: space-between; padding: 0 20px; }
        .brand { font-size: 16px; font-weight: 900; color: #fff; letter-spacing: 2px; display: flex; align-items: center; gap: 10px; }
        .brand span { color: var(--accent-yellow); }
        .admin-btn { font-family: var(--font-mono); font-size: 10px; padding: 5px 12px; border: 1px solid var(--accent-yellow); color: var(--accent-yellow); border-radius: 4px; cursor: pointer; display: none; background: rgba(255, 215, 0, 0.1); }
        .admin-btn:hover { background: var(--accent-yellow); color: #000; }

        #workspace { flex: 1; display: grid; grid-template-columns: 320px 1fr; overflow: hidden; }

        /* --- SIDEBAR --- */
        .sidebar { background: var(--bg-panel); border-right: 1px solid var(--border); display: flex; flex-direction: column; z-index: 10; box-shadow: 5px 0 20px rgba(0,0,0,0.2); }
        .p-head { padding: 15px; border-bottom: 1px solid var(--border); font-size: 11px; font-weight: 700; color: #fff; letter-spacing: 1px; background: rgba(0,0,0,0.2); }
        .p-body { flex: 1; overflow-y: auto; padding: 15px; }

        .module { margin-bottom: 20px; border-bottom: 1px dashed var(--border); padding-bottom: 15px; }
        .mod-title { font-size: 10px; color: var(--accent-yellow); font-weight: 700; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; }
        
        .aoi-box { border: 1px solid var(--border); padding: 10px; background: rgba(0,0,0,0.2); margin-bottom: 8px; border-radius: 4px; }
        .aoi-label { font-size: 9px; color: #ccc; font-weight: 700; margin-bottom: 5px; }
        .sys-select { width: 100%; background: #020b16; border: 1px solid var(--border); color: #fff; padding: 6px; font-family: var(--font-mono); font-size: 10px; outline: none; border-radius: 2px; }
        .upload-zone { border: 1px dashed #666; padding: 15px; text-align: center; cursor: pointer; transition: 0.2s; background: rgba(255,255,255,0.02); border-radius: 4px; }
        .upload-zone:hover { border-color: var(--accent-yellow); color: var(--accent-yellow); }

        /* --- TOGGLES --- */
        .vintage-row { display: flex; align-items: center; justify-content: space-between; padding: 8px 10px; border: 1px solid transparent; border-radius: 4px; cursor: pointer; transition: 0.2s; margin-bottom: 4px; background: rgba(0,0,0,0.2); }
        .vintage-row:hover { background: rgba(255,255,255,0.05); }
        .vintage-row.active { background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.1); }
        .vintage-row.disabled { opacity: 0.4; cursor: not-allowed; }
        
        .v-label { font-size: 11px; display: flex; align-items: center; gap: 8px; color: #aaa; }
        .v-dot { width: 8px; height: 8px; border-radius: 2px; }
        .v-status { font-size: 9px; font-family: var(--font-mono); color: #666; }
        
        /* Checkbox styling */
        .v-check { width: 14px; height: 14px; border: 1px solid #666; border-radius: 2px; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
        .vintage-row.active .v-check { background: var(--accent-yellow); border-color: var(--accent-yellow); }
        .vintage-row.active .v-check::after { content:'✓'; font-size: 10px; color: #000; font-weight: bold; }

        /* --- MAP --- */
        #map { width: 100%; height: 100%; background: #ffffff; z-index: 1; }

        /* --- ADMIN MODAL --- */
        #adminModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(2, 11, 22, 0.9); z-index: 20000; justify-content: center; align-items: center; }
        .admin-panel { width: 800px; height: 600px; background: var(--bg-panel); border: 2px solid var(--accent-yellow); border-radius: 8px; display: flex; flex-direction: column; box-shadow: 0 0 100px rgba(0,0,0,0.8); }
        .admin-header { padding: 20px; background: var(--accent-yellow); color: #000; font-weight: 900; font-size: 18px; letter-spacing: 2px; display: flex; justify-content: space-between; align-items: center; }
        .close-btn { cursor: pointer; font-size: 24px; font-weight: bold; }
        .admin-body { padding: 30px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; overflow-y: auto; }
        
        .year-card { background: rgba(0,0,0,0.3); border: 1px solid var(--border); padding: 20px; border-radius: 6px; }
        .year-title { color: #fff; font-weight: 700; margin-bottom: 10px; font-size: 14px; border-bottom: 1px solid var(--border); padding-bottom: 5px; }
        .year-status { float: right; font-size: 10px; padding: 2px 6px; border-radius: 2px; background: #000; color: #666; }
        .year-status.live { color: var(--accent-green); border: 1px solid var(--accent-green); }
        
        .admin-upload { width: 100%; border: 1px dashed #666; color: #888; padding: 15px; text-align: center; font-size: 11px; cursor: pointer; margin-top: 10px; border-radius: 4px; }
        .admin-upload:hover { border-color: var(--accent-yellow); color: var(--accent-yellow); background: rgba(255, 215, 0, 0.05); }

        /* --- AI WIDGET --- */
        .ai-widget { position: fixed; bottom: 20px; right: 20px; width: 320px; background: rgba(5, 30, 62, 0.95); border: 1px solid var(--border); z-index: 500; display: flex; flex-direction: column; border-radius: 6px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .ai-head { padding: 10px; background: rgba(0,0,0,0.3); border-bottom: 1px solid var(--border); font-size: 11px; font-weight: 700; color: #fff; display: flex; justify-content: space-between; }
        .ai-body { height: 160px; overflow-y: auto; padding: 10px; font-family: var(--font-mono); font-size: 11px; }
        .chat-row { display: flex; gap: 10px; margin-bottom: 8px; align-items: flex-start; opacity: 0; animation: fadeIn 0.3s forwards; }
        @keyframes fadeIn { to { opacity: 1; } }
        .avatar { width: 24px; height: 24px; border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; }
        .avatar.concierge { background: #064e3b; color: var(--accent-green); border: 1px solid var(--accent-green); }
        .avatar.engineer { background: #451a03; color: var(--accent-amber); border: 1px solid var(--accent-amber); }
        .bubble { background: rgba(0,0,0,0.4); padding: 6px 10px; border-radius: 4px; color: #ddd; line-height: 1.4; border: 1px solid rgba(255,255,255,0.1); }
        .cursor-trail { position: fixed; pointer-events: none; z-index: 9999; font-size: 24px; opacity: 0.8; transition: 0.1s; }

    </style>
</head>
<body>

<div id="loginOverlay">
    <div class="login-box">
        <div class="login-title">GPTM <span style="color:var(--accent-yellow)">GATEWAY</span></div>
        <input type="text" class="login-input" id="loginCompany" placeholder="COMPANY (Admin: COMMANDER)" onkeypress="handleLoginKey(event)">
        <input type="text" class="login-input" id="loginEmail" placeholder="EMAIL" onkeypress="handleLoginKey(event)">
        <button class="verify-btn" onclick="sendCode()" id="codeBtn">SEND CODE</button>
        <input type="text" class="login-input" id="loginCode" placeholder="VERIFICATION CODE (123456 / 000000)" onkeypress="handleLoginKey(event)">
        <div class="z-title">CURSOR SKIN SELECTOR</div>
        <div class="zodiac-grid" id="zodiacGrid"></div>
        <button class="enter-btn" onclick="checkLogin()">AUTHENTICATE</button>
    </div>
</div>

<div id="adminModal">
    <div class="admin-panel">
        <div class="admin-header">
            <span>COMMANDER CONSOLE</span>
            <span class="close-btn" onclick="toggleAdminPanel()">×</span>
        </div>
        <div class="admin-body">
            <div class="year-card" style="border-color:var(--accent-green);">
                <div class="year-title">2023 ARCHIVE (BASE) <span class="year-status live">LIVE</span></div>
                <div style="font-size:10px; color:#fff; margin-bottom:5px;">SOURCE: 2023.SHP (LOCKED)</div>
                <div class="admin-upload" style="border-color:var(--accent-green); color:var(--accent-green); cursor:default;">
                    <i class="ph ph-check-circle"></i> BASELINE ACTIVE
                </div>
            </div>
            <div class="year-card">
                <div class="year-title">2024 COLLECTION <span class="year-status" id="st-2024">OFFLINE</span></div>
                <div class="admin-upload" onclick="adminUpload('2024')"><i class="ph ph-upload-simple"></i> UPLOAD VECTOR</div>
            </div>
            <div class="year-card">
                <div class="year-title">2025 COLLECTION <span class="year-status" id="st-2025">OFFLINE</span></div>
                <div class="admin-upload" onclick="adminUpload('2025')"><i class="ph ph-upload-simple"></i> UPLOAD VECTOR</div>
            </div>
            <div class="year-card">
                <div class="year-title">2026 PREVIEW <span class="year-status" id="st-2026">LOCKED</span></div>
                <div class="admin-upload" onclick="adminUpload('2026')"><i class="ph ph-upload-simple"></i> UPLOAD VECTOR</div>
            </div>
        </div>
    </div>
</div>

<div id="app">
    <header>
        <div class="brand"><i class="ph ph-globe-hemisphere-east"></i> GPTM <span>SOVEREIGN</span></div>
        <div style="display:flex; gap:10px; align-items:center;">
            <div class="admin-btn" id="adminBtn" onclick="toggleAdminPanel()">COMMAND CENTER</div>
            <div class="user-badge" id="headerUser">GUEST</div>
        </div>
    </header>

    <div id="workspace">
        <div class="sidebar">
            <div id="panel-compliance">
                <div class="p-head">COMPLIANCE PROTOCOL</div>
                <div class="p-body">
                    <div class="module">
                        <div class="mod-title">STEP 1: APPLICATION</div>
                        <div style="font-size:10px; color:#ccc; margin-bottom:10px;">Request access to Dubai JVC Sample.</div>
                        <button class="enter-btn" style="margin-top:0;" onclick="startWorkflow()">APPLY FOR DATA</button>
                    </div>
                </div>
            </div>

            <div id="panel-mission" style="display:none;">
                <div class="p-head">COVERAGE SCOPE</div>
                <div class="p-body">
                    <div class="module">
                        <div class="mod-title">1. TARGET DEFINITION</div>
                        <div class="aoi-box">
                            <div class="aoi-label">ADMINISTRATIVE SELECT</div>
                            <select class="sys-select" onchange="map.setView([25.05, 55.2], 10)">
                                <option>GLOBAL</option><option>NATIONAL</option><option>UAE (DUBAI)</option>
                            </select>
                        </div>
                        <div class="aoi-box">
                            <div class="aoi-label">CUSTOM UPLOAD</div>
                            <div class="upload-zone" onclick="alert('Upload Dialog Open')"><i class="ph ph-file-arrow-up"></i> UPLOAD .ZIP / .KML</div>
                        </div>
                    </div>

                    <div class="module" style="border:none;">
                        <div class="mod-title">2. VINTAGE SELECTION</div>
                        <div class="vintage-row active" id="row-2023" onclick="toggleLayer('2023')">
                            <div class="v-label">
                                <div class="v-check"></div>
                                <div class="v-dot" style="background:var(--accent-data-23)"></div>
                                2023 ARCHIVE
                            </div>
                            <div class="v-status" style="color:var(--accent-green)">ONLINE</div>
                        </div>

                        <div class="vintage-row disabled" id="row-2024" onclick="toggleLayer('2024')">
                            <div class="v-label"><div class="v-check"></div><div class="v-dot" style="background:#6366f1"></div> 2024 COLLECTION</div>
                            <div class="v-status">OFFLINE</div>
                        </div>

                        <div class="vintage-row disabled" id="row-2025" onclick="toggleLayer('2025')">
                            <div class="v-label"><div class="v-check"></div><div class="v-dot" style="background:var(--accent-data-25)"></div> 2025 COLLECTION</div>
                            <div class="v-status">OFFLINE</div>
                        </div>
                        
                        <div class="vintage-row disabled" id="row-2026">
                            <div class="v-label"><div class="v-check"></div><div class="v-dot" style="background:var(--accent-amber)"></div> 2026 PREVIEW</div>
                            <div class="v-status">LOCKED</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="map"></div>
    </div>
</div>

<div class="ai-widget">
    <div class="ai-head"><span>SYSTEM LOG</span><div style="font-size:9px; color:#888;">GPTM AI v43.0</div></div>
    <div class="ai-body" id="chatBody"></div>
</div>

<script>
    // --- 1. SETUP ---
    const map = L.map('map', { zoomControl: false, minZoom: 2 }).setView([20, 0], 2);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', { maxZoom: 19 }).addTo(map);
    
    // LAYERS
    const layers = {
        '2023': L.featureGroup().addTo(map), // 2023 LOADED BY DEFAULT
        '2024': L.featureGroup(),
        '2025': L.featureGroup(),
        '2026': L.featureGroup()
    };

    // GENERATE MOCK 2023 DATA (Simulating the 2023.shp load)
    function load2023Baseline() {
        // Create some global polygons to represent 2023 data
        const coords = [
            [[30, -90], [40, -80]], [[35, 100], [45, 110]], [[-20, -60], [-10, -50]], [[10, 20], [20, 30]]
        ];
        coords.forEach(b => L.rectangle(b, { color: '#64748b', weight: 1, fillOpacity: 0.3 }).addTo(layers['2023']));
        console.log("2023.shp loaded.");
    }
    load2023Baseline();

    // ZODIAC
    const zodiacs = ['♈','♉','♊','♋','♌','♍','♎','♏','♐','♑','♒','♓'];
    const zGrid = document.getElementById('zodiacGrid');
    let currentCursor = '♈';
    zodiacs.forEach(z => {
        const btn = document.createElement('div');
        btn.className = 'z-btn'; btn.innerHTML = `<div class="z-icon">${z}</div>`;
        btn.onclick = () => {
            document.querySelectorAll('.z-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected'); currentCursor = z;
        };
        zGrid.appendChild(btn);
    });
    zGrid.children[0].classList.add('selected');

    // --- 2. AI LOGIC ---
    function addChat(role, text) {
        const body = document.getElementById('chatBody');
        const row = document.createElement('div'); row.className = 'chat-row';
        let av = role === 'concierge' ? '☺' : '⚡';
        let name = role === 'concierge' ? 'Concierge' : 'Lead Engineer';
        row.innerHTML = `<div class="avatar ${role}">${av}</div><div class="bubble"><b>${name}:</b><br>${text}</div>`;
        body.appendChild(row); body.scrollTop = 9999;
    }

    // --- 3. LOGIN ---
    function handleLoginKey(e) { if(e.key==='Enter') checkLogin(); }
    function sendCode() { addChat('concierge', 'Code sent: 123456'); }
    function checkLogin() {
        const comp = document.getElementById('loginCompany').value.toUpperCase();
        const code = document.getElementById('loginCode').value;
        if(comp==='COMMANDER' && code==='000000') { activateGodMode(); return; }
        if(code!=='123456') { addChat('engineer', 'Code invalid.'); return; }
        loginUser(comp);
    }
    function loginUser(name) {
        document.getElementById('loginOverlay').style.display='none';
        document.getElementById('app').classList.add('unlocked');
        document.getElementById('headerUser').innerText = name;
        startCursor(currentCursor);
        addChat('concierge', `Welcome ${name}. 2023 Baseline is active.`);
    }
    function activateGodMode() {
        document.body.classList.add('god-mode');
        document.getElementById('loginOverlay').style.display='none';
        document.getElementById('app').classList.add('unlocked');
        document.getElementById('headerUser').innerText="COMMANDER";
        document.getElementById('headerUser').style.color="var(--accent-yellow)";
        document.getElementById('adminBtn').style.display="block";
        document.getElementById('panel-compliance').style.display='none';
        document.getElementById('panel-mission').style.display='block';
        startCursor('♛');
        addChat('engineer', 'Commander logged in. 2023 Vector is locked and live.');
    }
    function startCursor(char) {
        document.addEventListener('mousemove', (e) => {
            const el = document.createElement('div'); el.className = 'cursor-trail'; el.innerText = char;
            el.style.left = e.pageX+'px'; el.style.top = e.pageY+'px';
            if(document.body.classList.contains('god-mode')) el.style.color='#ffd700'; else el.style.color='#333';
            document.body.appendChild(el); setTimeout(()=>el.remove(), 200);
        });
    }

    // --- 4. LAYER TOGGLE LOGIC ---
    function toggleLayer(year) {
        const row = document.getElementById(`row-${year}`);
        if(row.classList.contains('disabled')) return;
        row.classList.toggle('active');
        if(row.classList.contains('active')) {
            map.addLayer(layers[year]);
            addChat('engineer', `Layer ${year} enabled.`);
        } else {
            map.removeLayer(layers[year]);
        }
    }

    // --- 5. ADMIN & WORKFLOW ---
    function toggleAdminPanel() { const el=document.getElementById('adminModal'); el.style.display=el.style.display==='flex'?'none':'flex'; }
    function adminUpload(year) {
        const st = document.getElementById(`st-${year}`);
        st.innerText="UPLOADING..."; st.style.color="var(--accent-amber)";
        setTimeout(()=>{
            st.innerText="ONLINE"; st.className="year-status live";
            addChat('engineer', `${year} Vector uploaded. Layer activated.`);
            // Unlock UI
            const row = document.getElementById(`row-${year}`);
            row.classList.remove('disabled');
            row.querySelector('.v-status').innerText = "ONLINE";
            row.querySelector('.v-status').style.color = "var(--accent-green)";
        }, 1000);
    }
    function startWorkflow() {
        document.getElementById('panel-compliance').style.display='none';
        document.getElementById('panel-mission').style.display='block';
        addChat('concierge', 'Access granted. 2023 Baseline visible.');
    }

    // Init
    addChat('concierge', 'System Online. 2023.shp loaded.');

</script>

</body>
</html>