<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Open data only. Archive coverage + pass planning (reference only)." />
  <meta name="theme-color" content="#070b14" />
  <title>Satellite Discovery Index</title>

  <!-- Leaflet -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <!-- HUD Theme (cache-bust for GH Pages) -->
  <link rel="stylesheet" href="./styles.css?v=20251223-1" />
</head>

<body>
  <!-- Topbar -->
  <header class="topbar">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <div class="title">Satellite Discovery Index</div>
        <div class="subtitle">Open data only · No login · Archive coverage + pass planning (reference only)</div>
      </div>
    </div>

    <nav class="nav" aria-label="Primary">
      <a class="navlink" href="#aoi">AOI</a>
      <a class="navlink" href="#coverage">Coverage</a>
      <a class="navlink" href="#footprints">Footprints</a>
      <a class="navlink" href="#programming">Programming</a>
      <a class="navlink" href="#sources">Sources</a>
    </nav>
  </header>

  <!-- Toast / Status -->
  <div id="toast" class="toast" role="status" aria-live="polite" aria-atomic="true"></div>

  <!-- Main layout -->
  <main class="layout">
    <!-- Left Panel -->
    <aside class="panel" aria-label="Controls">

      <!-- 1) AOI SETUP -->
      <section id="aoi" class="card">
        <h2>1) AOI SETUP</h2>

        <div class="row field">
          <label for="place">Place search (optional)</label>
          <div class="inline">
            <input id="place" type="text" placeholder="Beijing / Dubai / New York" autocomplete="off" />
            <button id="btnLocate" class="btn btn-secondary" type="button">
              <span class="btnText">Locate</span>
              <span class="spinner" aria-hidden="true"></span>
            </button>
          </div>
          <div class="hint">Uses OpenStreetMap Nominatim public geocoding (rate-limited).</div>

          <div class="aoiBox" style="margin-top:12px;">
            <div class="aoiTitle">AOI STATUS</div>
            <div class="aoiSummary" id="aoiSummary">
              No AOI set. Use place search or draw/select on map (if enabled).
            </div>
          </div>
        </div>
      </section>

      <!-- 2) ARCHIVE COVERAGE INDEX -->
      <section id="coverage" class="card">
        <h2>2) ARCHIVE COVERAGE INDEX (REFERENCE)</h2>

        <div class="row field">
          <label>Time range (for open STAC signal checks)</label>
          <div class="inline">
            <input id="fromMonth" type="month" />
            <span class="hint" style="margin:0 2px;">→</span>
            <input id="toMonth" type="month" />
          </div>

          <div style="margin-top:10px; display:flex; gap:10px;">
            <button id="btnCheckCoverage" class="btn btn-primary" type="button">Check</button>
            <button id="btnReset" class="btn btn-ghost" type="button">Reset</button>
          </div>

          <div class="hint">Reference-only indicators; not a procurement workflow.</div>
        </div>

        <div class="row indexList" id="coverageIndex"></div>
      </section>

      <!-- 3) OPEN STAC FOOTPRINTS -->
      <section id="footprints" class="card">
        <h2>3) OPEN STAC FOOTPRINTS (LOADABLE PUBLIC DATA)</h2>

        <div class="row field">
          <label for="stacUrl">STAC API / Catalog URL</label>
          <input id="stacUrl" type="text" placeholder="https://planetarycomputer.microsoft.com/api/stac/v1" />
          <div class="hint">
            If provided, we will attempt STAC /search (GET then POST fallback). CORS may block some endpoints.
          </div>
        </div>

        <div class="row" style="display:flex; gap:10px;">
          <button id="btnLoadFootprints" class="btn btn-primary" type="button">
            <span class="btnText">Load Footprints</span>
            <span class="spinner" aria-hidden="true"></span>
          </button>
          <button id="btnClearFootprints" class="btn btn-secondary" type="button">Clear</button>
        </div>

        <div class="row indexList" id="footprintIndex"></div>
      </section>

      <!-- 4) PROGRAMMING INDEX -->
      <section id="programming" class="card">
        <h2>4) PROGRAMMING INDEX (FUTURE PASSES · REFERENCE)</h2>

        <div class="row field">
          <label for="satName">Satellite / Constellation</label>
          <input id="satName" type="text" placeholder="(optional) e.g., Sentinel-2 / Landsat / ..." list="satHints" />
          <datalist id="satHints"></datalist>
          <div class="hint">Reference-only. For production pass predictions, plug in your orbital engine (SGP4 + ground track).</div>
        </div>

        <div class="row" style="display:flex; gap:10px;">
          <button id="btnPlan" class="btn btn-primary" type="button">Generate Reference</button>
          <button id="btnPlanClear" class="btn btn-secondary" type="button">Clear</button>
        </div>

        <div class="row indexList" id="planIndex"></div>
      </section>

      <!-- 5) SOURCES -->
      <section id="sources" class="card">
        <h2>5) SOURCES (PUBLIC PORTALS · TRANSPARENCY)</h2>

        <!-- Dynamic sources list (loaded from sources.json; fallback below if load fails) -->
        <div class="sources" id="sourcesList">
          <div class="source">
            <div class="sourceTop">
              <div class="sourceName">OpenStreetMap / Nominatim</div>
              <span class="pill ok">Public</span>
            </div>
            <div class="sourceDesc">Geocoding reference (place search).</div>
          </div>
          <div class="source">
            <div class="sourceTop">
              <div class="sourceName">Leaflet + Basemap Provider</div>
              <span class="pill warn">Tiles</span>
            </div>
            <div class="sourceDesc">Map rendering and base tiles; attribution required.</div>
          </div>
          <div class="source">
            <div class="sourceTop">
              <div class="sourceName">STAC (optional)</div>
              <span class="pill ok">Open</span>
            </div>
            <div class="sourceDesc">Footprints & metadata via public STAC endpoints (CORS dependent).</div>
          </div>
        </div>

        <div class="footer">
          <div class="footerLine">
            Notice: Open data only. This site provides reference-level indicators (coverage & planning).
            It does not replace official portals or procurement workflows.
          </div>
        </div>
      </section>

    </aside>

    <!-- Map -->
    <section class="mapWrap" aria-label="Map">
      <div class="mapChrome" aria-hidden="true">
        <div class="hudTag">OPEN · NO LOGIN</div>
        <div class="hudTag">REFERENCE ONLY</div>
      </div>
      <div id="map"></div>
    </section>
  </main>

  <!-- Leaflet -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <!-- App (cache-bust for GH Pages) -->
  <script src="./app.js?v=20251223-1"></script>
</body>
</html>
